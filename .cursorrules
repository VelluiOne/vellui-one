# üó∫Ô∏è MAPA DE CONSTRU√á√ÉO & DIRETRIZES: VELLUI ONE

## 1. VIS√ÉO DO PRODUTO
O Vellui One √© uma plataforma SaaS Multi-tenant de Gest√£o de Atendimento e Opera√ß√£o, centralizando WhatsApp, PABX (Yeastar) e CRM, transformando toda a jornada do cliente em processos audit√°veis e rastre√°veis (Tickets/SLA/Kanban).

## 2. REGRAS DE OURO (DIRETRIZES T√âCNICAS)
- **Isolamento Total (Multi-tenant):** Toda e qualquer query ao banco de dados DEVE incluir o filtro `companyId`. O vazamento de dados entre empresas √© uma falha cr√≠tica.
- **Seguran√ßa:** Jamais exponha chaves de API ou segredos no c√≥digo. Use sempre `.env`.
- **Stack Tecnol√≥gica:** Next.js (App Router), Tailwind CSS, ShadcnUI, Prisma ORM e PostgreSQL.
- **Modularidade:** Mantenha a l√≥gica de CRM, Tickets e Chat separada.
- **Mobile First:** Todas as interfaces devem ser responsivas e operacionais em smartphones.

## üìë 3. MASTER BLUEPRINT (PILORES DE NEG√ìCIO)

### PILAR 0: FUNDA√á√ÉO & ACESSO
- Hierarquia: `SUPERADMIN` (Vellui), `OWNER` (Dono da Empresa), `ADMIN` (Gerente) e `USER` (Atendente).
- Cada empresa (Tenant) possui seu pr√≥prio subdom√≠nio ou identificador via URL `[domain]`.

### PILAR 1: CRM & KANBAN (VENDAS)
- **DNA do Lead:** Captura obrigat√≥ria da origem (`source`), meio (`medium`) e campanha.
- **Gatilhos de Estagna√ß√£o:** Cards mudam de cor se ficarem parados por muito tempo.
- **BI de Perda:** Exigir `lossReason` (motivo de perda) ao mover cards para "Perdido".

### PILAR 2 & 3: COMUNICA√á√ÉO (WHATSAPP & YEASTAR)
- **Timeline Unificada:** Exibir mensagens de Whats e Logs de Voz em uma √∫nica linha do tempo.
- **Transcri√ß√£o de √Åudio:** IA deve converter √°udios recebidos em texto na timeline.
- **Screen Pop:** Identificar chamadas recebidas via API Yeastar e abrir a ficha do cliente automaticamente.

### PILAR 4: GEST√ÉO DE CHAMADOS (SAC/SUPORTE)
- **Protocolo de Ticket:** Gerar n√∫mero de chamado sequencial por empresa.
- **Controle de SLA:** Rastrear "Tempo de Primeira Resposta" e "Tempo de Resolu√ß√£o".
- **Pesquisa NPS:** Disparo autom√°tico de satisfa√ß√£o via WhatsApp ap√≥s encerramento do Ticket.

### PILAR 5: INTELIG√äNCIA ARTIFICIAL (VELLUI IA)
- **Summarizer:** Bot√£o para resumir todo o hist√≥rico de um cliente (Conversas + Chamadas + Notas).
- **Sentiment Analysis:** Alertas ao gestor se um cliente demonstrar irrita√ß√£o extrema.

### PILAR 6 & 7: JUR√çDICO & BI
- **Auto-Contrato:** Gera√ß√£o de PDF e integra√ß√£o com Zipsign para assinatura digital.
- **Dashboards:** Funil de Convers√£o, Custo de Oportunidade e Ranking de Performance de Atendentes.

## üöÄ 4. CRONOGRAMA DE EXECU√á√ÉO
- **Sprint 1 (Backend):** Schema Prisma, Auth, Multi-tenant. (CONCLU√çDO)
- **Sprint 2 (Core UI):** Kanban, Listagem de Clientes e Gest√£o de Est√°gios. (EM ANDAMENTO)
- **Sprint 3 (Comunica√ß√£o):** Integra√ß√£o WhatsApp API e Yeastar Logs.
- **Sprint 4 (SAC & Suporte):** M√≥dulo de Tickets e SLA.
- **Sprint 5 (Automa√ß√£o & Dashboards):** Zipsign, Resumos IA e BI.